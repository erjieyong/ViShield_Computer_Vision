(()=>{let e=chrome.runtime.getURL("/images/replaceImg.jpg");const t=128;let s=function(){let e=document.getElementsByTagName("img");for(let t=0;t<e.length;t++)if(!e[t].classList.contains("filtered")){e[t].classList.add("filtered");let s=e[t].src;console.log(`check on image ${t}, url: ${s}`),r("image",t,s)}},r=function(e,s,r){(async(e,s)=>{const r=new Image;r.crossOrigin="anonymous",r.onerror=function(t){console.warn(`Could not load image from external source ${e}.`),s({rawImageData:void 0})},r.onload=async function(e){if(r.height&&r.height>t||r.width&&r.width>t){r.width=224,r.height=224;const e=new OffscreenCanvas(r.width,r.height).getContext("2d");e.drawImage(r,0,0,224,224);const t=e.getImageData(0,0,r.width,r.height);s({rawImageData:Array.from(t.data),width:r.width,height:r.height})}else console.warn(`Image size too small. [${r.height} x ${r.width}] vs. minimum [128 x 128]`),s({rawImageData:void 0})},r.src=e})(r,(function(t){chrome.runtime.sendMessage({msg:e,index:s,url:r,data:t})}))};s(),chrome.runtime.onMessage.addListener(((t,s,r)=>{console.log(t),chrome.storage.local.get(["dogfilter","catfilter","snakefilter","trypofilter"],(function(s){let r=document.getElementsByTagName("img");for(let e=0;e<r.length;e++)r[e].src!=t.url&&r[e].srcset!=t.url||r[e].insertAdjacentHTML("afterend",`<div style = "position: absolute;bottom: 8px;right: 16px;">${Object.keys(t.results)[0]}, ${Object.values(t.results)[0].toFixed(4)}</div>`);if(s.dogfilter&&"dog"==Object.keys(t.results)[0])for(let s=0;s<r.length;s++)r[s].src!=t.url&&r[s].srcset!=t.url||(r[s].src=e,r[s].srcset=e);if(s.catfilter&&"cat"==Object.keys(t.results)[0]){let s=document.getElementsByTagName("img");for(let r=0;r<s.length;r++)s[r].src!=t.url&&s[r].srcset!=t.url||(s[r].src=e,s[r].srcset=e,s[r].insertAdjacentHTML("afterend",`<div style = "position: absolute;bottom: 8px;right: 16px;">${Object.keys(t.results)[0]}, ${Object.values(t.results)[0].toFixed(4)}</div>`))}if(s.snakefilter&&"snake"==Object.keys(t.results)[0]){let s=document.getElementsByTagName("img");for(let r=0;r<s.length;r++)s[r].src!=t.url&&s[r].srcset!=t.url||(s[r].src=e,s[r].srcset=e,s[r].insertAdjacentHTML("afterend",`<div style = "position: absolute;bottom: 8px;right: 16px;">${Object.keys(t.results)[0]}, ${Object.values(t.results)[0].toFixed(4)}</div>`))}if(s.trypofilter&&"trypo"==Object.keys(t.results)[0]){let s=document.getElementsByTagName("img");for(let r=0;r<s.length;r++)s[r].src!=t.url&&s[r].srcset!=t.url||(s[r].src=e,s[r].srcset=e,s[r].insertAdjacentHTML("afterend",`<div style = "position: absolute;bottom: 8px;right: 16px;">${Object.keys(t.results)[0]}, ${Object.values(t.results)[0].toFixed(4)}</div>`))}}))})),new MutationObserver(s).observe(document.body,{childList:!0,subtree:!0})})();
//# sourceMappingURL=contentScript.js.map
